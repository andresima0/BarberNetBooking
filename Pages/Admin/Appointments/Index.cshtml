@page
@model BarberNetBooking.Pages.Admin.Appointments.IndexModel
@{
    Layout = "/Pages/Shared/_AdminLayout.cshtml";
    ViewData["Title"] = "Agendamentos";
}

<section class="card">
    <h2>Filtrar</h2>
    <form method="get">
        <partial name="_Filters" model="Model.Filters" />
        <button class="btn" type="submit">Aplicar</button>
    </form>
</section>

<section class="card light">
    <h3>Resultados</h3>
    <table class="tbl">
        <thead>
            <tr><th>Data</th><th>Hora</th><th>Serviço</th><th>Barbeiro</th><th>Cliente</th><th>Status</th><th class="right">Ações</th></tr>
        </thead>
        <tbody>
        @foreach (var a in Model.Items)
        {
            <tr>
                <td>@a.Date.ToString("MM/dd/yyyy")</td>
                <td>@a.StartTime.ToString("HH:mm")</td>
                <td>@a.Service?.Name</td>
                <td>@a.Barber?.Name</td>
                <td>@a.CustomerEmail<br/><small>@a.CustomerPhone</small></td>
                <td>@a.Status</td>
                <td class="right">
                    @if (a.Status == BarberNetBooking.Models.AppointmentStatus.Confirmed)
                    {
                        <form method="post" asp-page-handler="Cancel" style="display:inline">
                            <input type="hidden" name="id" value="@a.Id" />
                            <button class="btn" type="submit">Cancelar</button>
                        </form>
                        <details style="display:inline-block; margin-left:8px;">
                            <summary>Remarcar</summary>
                            <form method="post" asp-page-handler="Reschedule">
                                <input type="hidden" name="id" value="@a.Id" />
                                <label>Data<input name="date" type="date" value="@Model.DefaultRescheduleDate.ToString("yyyy-MM-dd")"/></label>
                                <label>Hora<input name="time" type="time" step="1800" value="09:00"/></label>
                                <button class="btn" type="submit">Salvar</button>
                            </form>
                        </details>
                    }
                </td>
            </tr>
        }
        </tbody>
    </table>
</section>
